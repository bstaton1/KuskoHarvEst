
# Harvest Estimates {-}

```{r estimate-harvest}
# estimate (via bootstrap) drift net harvest for all species and and strata
boot_out_drift = bootstrap_harvest(interview_data, drift_effort_info,
                                   gear = "drift", n_boot = n_boot, stratify_interviews = TRUE)

# estimate (via bootstrap) set net harvest for all species and and strata
boot_out_set = bootstrap_harvest(interview_data, set_effort_info,
                                 gear = "set", n_boot = n_boot, stratify_interviews = FALSE)

# sum up across gears
boot_out_total = data.frame(iter = boot_out_drift$iter, 
                            date = boot_out_drift$date,
                            gear = "total", 
                            stratum = boot_out_drift$stratum,
                            chinook = rowSums(cbind(boot_out_drift[,"chinook"], boot_out_set[,"chinook"]), na.rm = TRUE),
                            chum = rowSums(cbind(boot_out_drift[,"chum"], boot_out_set[,"chum"]), na.rm = TRUE),
                            sockeye = rowSums(cbind(boot_out_drift[,"sockeye"], boot_out_set[,"sockeye"]), na.rm = TRUE),
                            total = rowSums(cbind(boot_out_drift[,"total"], boot_out_set[,"total"]), na.rm = TRUE)
)

# combine drift, set, and total into one data frame of bootstrap output
boot_out <<- rbind(boot_out_total, boot_out_drift, boot_out_set)
```

```{r set-summaries}
set_harvest = sapply(c("chinook", "chum", "sockeye", "total"), function(sp) report(sp, gear = "set", CI = FALSE, return_numeric = TRUE))
set_spp = percentize(set_harvest[c("chinook", "chum", "sockeye")]/set_harvest["total"])
```

* An estimated total of **`r report()`** salmon were harvested.
  * An estimated total of **`r report(spp = "chinook")`** Chinook salmon were harvested.
  * An estimated total of **`r report(spp = "chum")`** chum salmon were harvested.
  * An estimated total of **`r report(spp = "sockeye")`** sockeye salmon were harvested.
* Harvest by set nets accounted for an estimated **`r report(gear = "set")`** total salmon (`r paste0(set_spp["chinook"], " Chinook salmon, ", set_spp["chum"], " chum salmon, and ", set_spp["sockeye"], " sockeye salmon")`).

```{r strata-summary-table}
strata_summary_table(interview_data, "drift")
```
